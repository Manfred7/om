/* jQuery Plugin Name: Koottam
 * Author Name: Joby Joseph
 * Author Website: www.jobyj.in
 * Copyright 2012, Joby Joseph
 * Licensed under MIT
 */
(function(c){c.fn.koottam=function(n){var k=c(this);var g=c.extend({id:"jobysblog",service:"facebook",method:"custom",count:0,style:"image_count",theme:"default",count_style:"static",size:"default",cell_color_style:"100",icon_url:"",nameology:"followers"},n);k.css({"text-decoration":"none",position:"relative"});k.html('<span class="social-button-style"></span>');var m=g.cell_color_style.split("");var f=2;if(g.style!="image_count"&&g.style!="logo_count"){f=3}for(var l=1;l<=f;l++){if(m[l-1]==0){k.find(".social-button-style").append('<span class="button cell'+l+'"></span>')}else{k.find(".social-button-style").append('<span class="button '+g.theme+" cell"+l+'"></span>')}}if(g.size=="large"){k.find(".button").addClass("large")}if(g.style=="image_count"){k.find(".button:first").addClass("img")}k.find(".button:last").html("0");var d="";var j="";var h=0;var e=0;if(g.service=="facebook"){if(g.style=="image_count"){k.find(".button:first").html('<img src="'+g.icon_url+'"/>')}else{if(g.style=="logo_count"){k.find(".button:first").html("Facebook")}else{if(g.style=="image_logo_count"){k.find(".button:first").html('<img src="'+g.icon_url+'"/>');k.find(".button:nth-child(2)").html("Facebook")}else{if(g.style=="image_id_count"){k.find(".button:first").html('<img src="'+g.icon_url+'"/>');k.find(".button:nth-child(2)").html("@"+g.id)}}}}if(g.method=="api"){d="https://graph.facebook.com/"+g.id;c.ajax({url:d,dataType:"jsonp",success:function(i){if(g.count_style=="static"){a(k,i.likes)}else{h=parseInt(i.likes,10);e=Math.round(h/50);b(k,0,e,h)}}})}else{if(g.method=="custom"){if(g.count_style=="static"){a(k,g.count)}else{h=parseInt(g.count,10);e=Math.round(h/50);b(k,0,e,h)}}}}else{if(g.service=="twitter"){if(g.style=="image_count"){k.find(".button:first").html('<img src="'+g.icon_url+'"/>')}else{if(g.style=="logo_count"){k.find(".button:first").html("Twitter")}else{if(g.style=="image_logo_count"){k.find(".button:first").html('<img src="'+g.icon_url+'"/>');k.find(".button:nth-child(2)").html("Twitter")}else{if(g.style=="image_id_count"){k.find(".button:first").html('<img src="'+g.icon_url+'"/>');k.find(".button:nth-child(2)").html("@"+g.id)}}}}if(g.method=="api"){d="https://api.twitter.com/1/users/lookup.json?screen_name="+g.id;c.ajax({url:d,dataType:"jsonp",success:function(o){if(g.count_style=="static"){a(k,o[0].followers_count)}else{var i=parseInt(o[0].followers_count,10);var p=Math.round(i/50);b(k,0,p,i)}}})}else{if(g.method=="custom"){if(g.count_style=="static"){a(k,g.count)}else{h=parseInt(g.count,10);e=Math.round(h/50);b(k,0,e,h)}}}}else{if(g.style=="image_count"){k.find(".button:first").html('<img src="'+g.icon_url+'"/>')}else{if(g.style=="logo_count"){k.find(".button:first").html(g.service)}else{if(g.style=="image_logo_count"){k.find(".button:first").html('<img src="'+g.icon_url+'"/>');k.find(".button:nth-child(2)").html(g.service)}else{if(g.style=="image_id_count"){k.find(".button:first").html('<img src="'+g.icon_url+'"/>');k.find(".button:nth-child(2)").html(g.id)}}}}if(g.method=="api"){alert("API method is not available for this service")}else{if(g.method=="custom"){if(g.count_style=="static"){a(k,g.count)}else{h=parseInt(g.count,10);e=Math.round(h/50);b(k,0,e,h)}}}}}k.find(".social-button-style").append('<span class="nameology">'+g.nameology+"</span>")};var a=function(d,e){var f="";e=parseInt(e,10);if(e>1000000){e=e/1000000;e=e.toFixed(1);f=e+" M"}else{if(e>1000){e=e/1000;e=e.toFixed(1);f=e+" K"}else{f=e}}d.find(".button:last").html(f)};var b=function(e,h,g,d){var f=0;if(h+g>=d){f=d;a(e,f)}else{f=h+g;a(e,f);setTimeout(function(){b(e,h+g,g,d)},100)}}})(jQuery);